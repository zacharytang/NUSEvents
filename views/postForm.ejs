<% include header.ejs %>

<form method="post" id="new_post" enctype="multipart/form-data">
    <div class="title form-group">
        <label for="title">Event Name: </label>
        <input type="text" class="form-control" id="title" name="title">
    </div>

    <div class="body form-group">
        <label for="texteditor">Description <small>(Maximum characters <%= maxChars %>)</small>: </label>
        <textarea class="form-control" rows="5" id="texteditor" name="content" maxlength=maxChars></textarea>
    </div>

    <div class="external form-group">
        <label for="external">External Link</label>
        <input type="text" class="form-control" id="external" name="externalLink">
    </div>

    <div class="category form-group">
        <label for="category">Category: </label>
        <select class="form-control" id="category" name="category">
            <% for (var i = 0; i < categories.length; i++) { %>
                <option value="<%= categories[i] %>"><%= capitalize(categories[i]) %></option>
            <% } %>
        </select>
    </div>

    <div class="image form-group">
        <label for="image">Upload A Poster</label>
        <input type="file" id="image" name="image" accept="image/*">
    </div>

    <input type="button" onclick="submitFormHandler()" value="Submit Event" class="btn btn-primary"/>
    <!-- Form handler to check if fields are empty -->
    <script type="text/javascript">
    function submitFormHandler() {
        var post = document.getElementById("new_post");
        // Check link
        var link = document.getElementsByName('externalLink')[0].value;
        var result = link.split("//");
        if (result[0] != "https:" && result[0] != "http:") {
            document.getElementsByName('externalLink')[0].value = "http://" + link;
        }

        // Check form for empty fields
        if (!(/\S/.test(document.getElementsByName("title")[0].value))) {
            alert("Please enter a title!");
        } else if (!(/\S/.test(document.getElementsByName("content")[0].value))) {
            alert("Please enter some content!");
        } else if (!(/\S/.test(document.getElementsByName("externalLink")[0].value))) {
            alert("Please provide an external link!");
        } else {
            post.submit();
        }
    }
    </script>
</form>
<% include footer.ejs %>
